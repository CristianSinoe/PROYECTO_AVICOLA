import{e as ce,f as de}from"./chunk-RWHKCYX6.js";import{a as me,b as pe}from"./chunk-DORXEB7Z.js";import{c as ae,d as ne,f as oe,g as re}from"./chunk-64NVNNMU.js";import{b as le,c as se}from"./chunk-FGSFZRNY.js";import{B as te,I as ie,o as Y,p as J,q as $,r as ee}from"./chunk-PH6CECEN.js";import{d as q}from"./chunk-F3B4DRXO.js";import"./chunk-EDRFJHPT.js";import{a as H}from"./chunk-3FZEPC3C.js";import{b as Q,c as X}from"./chunk-SD274BSR.js";import"./chunk-GLSPFAUM.js";import{e as K}from"./chunk-EXJJF4RX.js";import{Db as F,Eb as P,Fb as G,Gb as j,Na as T,Ra as D,Va as N,rb as B,t as O,tb as L,ub as W,xb as U}from"./chunk-C37TLAZK.js";import{$a as E,Bb as g,Fb as f,Gb as d,Lb as y,Mb as I,Nb as M,Oa as c,Rb as p,Sb as z,Ta as S,Vb as b,Wb as C,Xb as h,Yb as R,Zb as V,aa as s,ba as m,fb as x,lc as Z,mb as w,pa as k,pb as A,vb as i,wb as a,xb as _}from"./chunk-AN2PFFFI.js";import{a as v}from"./chunk-EQDQRRRY.js";var _e=["dt"],ge=()=>({width:"600px"});function fe(l,n){if(l&1){let e=g();i(0,"p-button",10),f("onClick",function(){s(e);let t=d();return m(t.openNew())}),a()}}function be(l,n){if(l&1){let e=g();i(0,"div",11)(1,"h5",12),p(2,"ADMINISTRACION DE KAZETAS"),a(),i(3,"p-iconfield"),_(4,"p-inputicon",13),i(5,"input",14),f("input",function(t){s(e);let r=d();return m(r.onGlobalFilter(t))}),a()()()}}function Ce(l,n){l&1&&(i(0,"tr"),_(1,"th",15),i(2,"th"),p(3,"NOMBRE"),a(),i(4,"th"),p(5,"UBICACION"),a(),i(6,"th"),p(7,"REGISTRO"),a(),_(8,"th"),a())}function he(l,n){if(l&1){let e=g();i(0,"tr"),_(1,"td"),i(2,"td"),p(3),a(),i(4,"td"),p(5),a(),i(6,"td"),p(7),a(),i(8,"td")(9,"p-button",16),f("click",function(){let t=s(e).$implicit,r=d();return m(r.editKazeta(t))}),a(),i(10,"p-button",17),f("click",function(){let t=s(e).$implicit,r=d();return m(r.deleteKazeta(t))}),a()()()}if(l&2){let e=n.$implicit;c(3),z(e.nombre),c(2),z(e.ubicacion),c(2),z(e.numRegistro),c(2),w("outlined",!0),c(),w("outlined",!0)}}function Se(l,n){if(l&1){let e=g();i(0,"div",18)(1,"div",19)(2,"label",20),p(3,"NOMBRE"),a(),i(4,"input",21),h("ngModelChange",function(t){s(e);let r=d();return C(r.kazeta.nombre,t)||(r.kazeta.nombre=t),m(t)}),a()(),i(5,"div",19)(6,"label",22),p(7,"UBICACION"),a(),i(8,"input",23),h("ngModelChange",function(t){s(e);let r=d();return C(r.kazeta.ubicacion,t)||(r.kazeta.ubicacion=t),m(t)}),a()(),i(9,"div",19)(10,"label",24),p(11,"CERTIFICADO SAGARPA"),a(),_(12,"p-fileUpload",25),a(),i(13,"div",19)(14,"label",26),p(15,"MOSTRAR CERTIFICADO"),a(),i(16,"p-toggleButton",27),h("ngModelChange",function(t){s(e);let r=d();return C(r.mostrarCertificado,t)||(r.mostrarCertificado=t),m(t)}),a()(),i(17,"div",19)(18,"label",28),p(19,"NUMERO DE REGISTRO"),a(),i(20,"input",29),h("ngModelChange",function(t){s(e);let r=d();return C(r.kazeta.numRegistro,t)||(r.kazeta.numRegistro=t),m(t)}),a()()()}if(l&2){let e=d();c(4),b("ngModel",e.kazeta.nombre),c(4),b("ngModel",e.kazeta.ubicacion),c(8),b("ngModel",e.mostrarCertificado),c(4),b("ngModel",e.kazeta.numRegistro)}}function we(l,n){if(l&1){let e=g();i(0,"p-button",30),f("click",function(){s(e);let t=d();return m(t.hideDialog())}),a(),i(1,"p-button",31),f("click",function(){s(e);let t=d();return m(t.saveKazeta())}),a()}}var ue=class l{constructor(n,e,o,t){this.route=n;this.dataService=e;this.messageService=o;this.confirmationService=t}kazetas=k([]);kazeta;kazetaDialog=!1;mostrarCertificado=!1;submitted=!1;selectedKazetas=[];dt;ngOnInit(){this.route.paramMap.subscribe(n=>{let e=n.get("zona");console.log("ZONA OBTENIDA DE LA RUTA:",e),e&&this.cargarKazetasZona(e)})}cargarKazetasZona(n){this.dataService.getData().subscribe(e=>{let o=e.promedioAlimento[n];if(!o||!o.labels){console.warn(`NO HAY DATOS PARA LA ZONA: ${n}`),this.kazetas.set([]);return}let t=o.labels.map((r,u)=>({id:`${n}-KZ${u+1}`,nombre:r,ubicacion:`UBICACION AUTOMATICA DE  ${r}`,numCasetas:1,certificadoSagarpa:"",numRegistro:""}));this.kazetas.set(t)})}openNew(){this.kazeta={id:"",nombre:"",ubicacion:"",numCasetas:0,certificadoSagarpa:"",numRegistro:""},this.submitted=!1,this.kazetaDialog=!0}editKazeta(n){this.kazeta=v({},n),this.kazetaDialog=!0}deleteKazeta(n){this.confirmationService.confirm({message:`\xBFESTAS SEGURDO DE ELIMINAR LA KAZETA "${n.nombre}"?`,header:"CONFIRMAR",icon:"pi pi-exclamation-triangle",acceptLabel:"SI",rejectLabel:"NO",accept:()=>{this.kazetas.set(this.kazetas().filter(e=>e.id!==n.id)),this.messageService.add({severity:"success",summary:"EXITO",detail:"KAZETA ELIMINADA",life:3e3})}})}saveKazeta(){this.submitted=!0,this.kazeta.nombre.trim()&&(this.kazeta.id?this.kazetas.set(this.kazetas().map(n=>n.id===this.kazeta.id?this.kazeta:n)):(this.kazeta.id="KZ"+(this.kazetas().length+1),this.kazetas.set([...this.kazetas(),this.kazeta])),this.messageService.add({severity:"success",summary:"EXITO",detail:"KAZETA GUARDADA",life:3e3}),this.kazetaDialog=!1)}hideDialog(){this.kazetaDialog=!1,this.submitted=!1}onGlobalFilter(n){let e=n.target.value;this.dt.filterGlobal(e,"contains")}static \u0275fac=function(e){return new(e||l)(S(K),S(H),S(D),S(T))};static \u0275cmp=E({type:l,selectors:[["app-zona-dashboard"]],viewQuery:function(e,o){if(e&1&&y(_e,5),e&2){let t;I(t=M())&&(o.dt=t.first)}},features:[R([D,T])],decls:14,vars:11,consts:[["start",""],["dt",""],[1,"mb-4"],["dataKey","id",3,"selectionChange","value","paginator","rows","rowHover","selection"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","Kazeta",3,"visibleChange","visible","modal","closable"],["pTemplate","content"],["pTemplate","footer"],["label","NUEVO","icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","BUSCAR...",3,"input"],["pSelectableRowCheckbox",""],["icon","pi pi-pencil",1,"mr-2",3,"click","outlined"],["icon","pi pi-trash","severity","danger",3,"click","outlined"],[1,"p-fluid","formgrid","grid","gap-3"],[1,"field","col-12","md:col-6"],["for","nombre"],["id","nombre","type","text","pInputText","",1,"w-full",3,"ngModelChange","ngModel"],["for","ubicacion"],["id","ubicacion","type","text","pInputText","",1,"w-full",3,"ngModelChange","ngModel"],["for","certificado"],["mode","basic","name","certificado","url","./upload","accept",".pdf","chooseLabel","SUBIR ARCHIVO"],["for","mostrarCert"],["onLabel","VER","offLabel","OCULTAR",1,"w-full",3,"ngModelChange","ngModel"],["for","numRegistro"],["id","numRegistro","type","text","pInputText","",1,"w-full",3,"ngModelChange","ngModel"],["label","CANCELAR","icon","pi pi-times","text","",3,"click"],["label","GUARDAR","icon","pi pi-check",3,"click"]],template:function(e,o){if(e&1){let t=g();i(0,"p-toolbar",2),x(1,fe,1,0,"ng-template",null,0,Z),a(),_(3,"br"),i(4,"p-table",3,1),h("selectionChange",function(u){return s(t),C(o.selectedKazetas,u)||(o.selectedKazetas=u),m(u)}),x(6,be,6,0,"ng-template",4)(7,Ce,9,0,"ng-template",5)(8,he,11,5,"ng-template",6),a(),i(9,"p-dialog",7),h("visibleChange",function(u){return s(t),C(o.kazetaDialog,u)||(o.kazetaDialog=u),m(u)}),x(10,Se,21,4,"ng-template",8)(11,we,2,0,"ng-template",9),a(),_(12,"p-toast")(13,"p-confirmdialog")}e&2&&(c(4),w("value",o.kazetas())("paginator",!0)("rows",10)("rowHover",!0),b("selection",o.selectedKazetas),c(5),A(V(10,ge)),b("visible",o.kazetaDialog),w("modal",!0)("closable",!1))},dependencies:[O,U,B,L,W,ie,te,N,ne,ae,P,F,re,oe,j,G,q,se,le,pe,me,J,Y,ee,$,de,ce,X,Q],encapsulation:2})};export{ue as ZonaDashboardComponent};
